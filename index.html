<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Our Space</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ✅ 챗봇 버튼 -->
  <div class="chatbot-button" id="chatbotBtn" onclick="toggleChatbot()">💬</div>
</body>
  <!-- ✅ 챗봇 창 -->
  <div class="chatbot-window" id="chatbot">
    <div class="chatbot-header">
      <span>챗봇 상담</span>
      <button onclick="toggleChatbot()">✖</button>
    </div>
    <div class="chatbot-body" id="chatbot-body">
      <p>안녕하세요! 무엇을 도와드릴까요?</p>
    </div>
    <div class="chatbot-input">
      <input type="text" id="chatInput" placeholder="메시지를 입력하세요..." />
      <button id="sendBtn">전송</button>
    </div>
  </div>

  <!-- 상단 메뉴 -->
  <header>
    <div class="nav-left">
      <a href="index.html">홈</a>
      <button id="darkModeToggle">🌙</button>
    </div>
    <div class="nav-center">
      <a href="board.html">게시판</a>
      <a href="#">다문화 가정</a>
      <a href="#">유학생</a>
      <a href="#">외국인 근로자</a>
    </div>
    <div class="nav-right" id="navRight">
      <a href="login.html">로그인</a>
      <a href="signup.html">회원가입</a>
    </div>
  </header>

  <!-- 메인 컨테이너 -->
  <div class="container">
    <h1>Welcome to Our Space 🌍</h1>
    <p>다문화 가정, 유학생, 외국인 근로자를 위한 글로벌 커뮤니티 플랫폼</p>
  </div>

  <!-- 하단 정보 -->
  <footer>
    <div class="footer">
      <p>사업자명: Our Space  | 대표자: 이상우  | 연락처: 010-1234-5678  | 이메일: ourspace@example.com</p>
      <p>&copy; 2025 Our Space. All rights reserved.</p>
    </div>
  </footer>

  <!-- 스크립트 -->
  <script>
    // 🌙 다크모드 토글
document.getElementById("darkModeToggle").addEventListener("click", () => {
  document.body.classList.toggle("dark-mode");
});

    function toggleChatbot() {
      const chatbot = document.getElementById("chatbot");
      chatbot.style.display = chatbot.style.display === "flex" ? "none" : "flex";
    }

    document.getElementById("sendBtn").addEventListener("click", async () => {
      const input = document.getElementById("chatInput");
      const message = input.value.trim();
      const chatBody = document.getElementById("chatbot-body");

      if (!message) return;

      const userMsg = document.createElement("p");
      userMsg.textContent = "🙋‍♂️ " + message;
      chatBody.appendChild(userMsg);
      input.value = "";

      const botMsg = document.createElement("p");
      botMsg.textContent = "🧠 답변을 불러오는 중...";
      chatBody.appendChild(botMsg);

      try {
        const response = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer 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"
          },
          body: JSON.stringify({
            model: "gpt-3.5-turbo",
            messages: [{ role: "user", content: message }]
          })
        });

        const data = await response.json();
        const reply = data.choices?.[0]?.message?.content || "❗ 응답을 이해할 수 없습니다.";
        botMsg.textContent = "🧠 " + reply;
        chatBody.scrollTop = chatBody.scrollHeight;
      } catch (error) {
        botMsg.textContent = "❗ 오류 발생: " + error.message;
      }
    });

    // 관리자 로그인 여부 확인
    const isAdmin = sessionStorage.getItem("isAdmin") === "true";
    if (isAdmin) {
      const navRight = document.getElementById("navRight");
      const adminLink = document.createElement("a");
      adminLink.href = "admin.html";
      adminLink.textContent = "관리자";
      navRight.appendChild(adminLink);
    }
  </script>
</body>
</html>
